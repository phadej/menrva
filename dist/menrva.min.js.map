{"version":3,"file":"dist/menrva.min.js","sources":["dist/menrva.standalone.js"],"names":["e","exports","module","define","amd","f","window","global","self","menrva","t","n","r","s","o","u","a","require","i","Error","call","length",1,"_dereq_","egal","b",2,"util","signal","Lens","parent","path","eq","this","parents","split","value","calculate","initSignal","prototype","Signal","calculateRank","rank","getPath","Source","zoom","mapped","children","push","set","tx","modify","obj","setPath","modifyPath","./signal.js","./util.js",3,"option","transaction","version","some","none","source","combine","./egal.js","./lens.js","./option.js","./transaction.js",4,"Option","Some","x","None","equals","other","map","elim","orElse","identity",5,"index","callbacks","CombinedSignal","Math","max","apply","pluck","undefined","onValue","callback","wrapped","that","indexOf","splice","initialValue","addAction","type","signals","Array","slice","arguments","forEach",6,"Transaction","actions","commitScheduled","calculateUpdates","updates","len","action","update","values","initialSet","updated","triggerOnValue","updatedSignal","callbacksLen","j","commit","clearTimeout","child","objIsEmpty","Infinity","rankK","min","next","curr","k","childrenlen","childIdx","currLen","currIdx","nextLen","nextIdx","rollback","deferCommit","setTimeout",7,"arr","property","res","setProperty","copy","acc"],"mappings":"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"}