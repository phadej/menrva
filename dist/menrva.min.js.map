{"version":3,"file":"dist/menrva.min.js","sources":["dist/menrva.standalone.js"],"names":["e","exports","module","define","amd","f","window","global","self","menrva","t","n","r","s","o","u","a","require","i","Error","code","l","call","length",1,"signal","Signal","prototype","log","args","Array","slice","arguments","this","onValue","x","logArgs","concat","console","apply","onSpread","callback","undefined","argsToArray","tuple","signals","combine","./signal.js",2,"egal","b",3,"util","Lens","parent","path","eq","parents","split","value","calculate","initSignal","calculateRank","rank","getPath","Source","zoom","mapped","children","push","set","tx","modify","obj","setPath","modifyPath","./util.js",4,"option","transaction","convenience","version","some","none","source","./convenience.js","./egal.js","./lens.js","./option.js","./transaction.js",5,"Option","Some","None","equals","other","map","elim","orElse","identity",6,"index","callbacks","CombinedSignal","Math","max","pluck","wrapped","that","indexOf","splice","initialValue","addAction","type","forEach",7,"Transaction","actions","commitScheduled","facts","isArray","len","calculateUpdates","updates","action","update","values","initialSet","updated","triggerOnValue","updatedSignal","callbacksLen","j","commit","clearTimeout","child","objIsEmpty","Infinity","rankK","min","next","curr","k","childrenlen","childIdx","currLen","currIdx","nextLen","nextIdx","rollback","deferCommit","setTimeout",8,"arr","property","res","setProperty","copy","acc"],"mappings":"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"}