!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var f;"undefined"!=typeof window?f=window:"undefined"!=typeof global?f=global:"undefined"!=typeof self&&(f=self),f.jsc=e()}}(function(){var define,module,exports;return function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);throw new Error("Cannot find module '"+o+"'")}var f=n[o]={exports:{}};t[o][0].call(f.exports,function(e){var n=t[o][1][e];return s(n?n:e)},f,f.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s}({1:[function(_dereq_,module,exports){"use strict";function egal(a,b){if(a===0&&b===0){return 1/a===1/b}else if(a!==a){return b!==b}else{return a===b}}module.exports=egal},{}],2:[function(_dereq_,module,exports){"use strict";var egal=_dereq_("./egal.js");var option=_dereq_("./option.js");var signal=_dereq_("./signal.js");var transaction=_dereq_("./transaction.js");module.exports={egal:egal,some:option.some,none:option.none,Signal:signal.Signal,source:signal.source,combine:signal.combine,transaction:transaction}},{"./egal.js":1,"./option.js":3,"./signal.js":4,"./transaction.js":5}],3:[function(_dereq_,module,exports){"use strict";var egal=_dereq_("./egal.js");var util=_dereq_("./util.js");function Option(){}function Some(x){this.value=x}Some.prototype=new Option;function some(x){return new Some(x)}function None(){}None.prototype=new Option;var none=new None;Some.prototype.equals=function(other,eq){eq=eq||egal;return other instanceof Some&&eq(this.value,other.value)};None.prototype.equals=function(other){return this===other};Some.prototype.map=function(f){return some(f(this.value))};None.prototype.map=function(f){return none};Some.prototype.elim=function(x,f){return f(this.value)};None.prototype.elim=function(x,f){return x};Option.prototype.orElse=function(x){return this.elim(x,util.identity)};module.exports={some:some,none:none}},{"./egal.js":1,"./util.js":6}],4:[function(_dereq_,module,exports){"use strict";var egal=_dereq_("./egal.js");var util=_dereq_("./util.js");function Signal(){}function initSignal(signal,value,eq){signal.children=[];signal.callbacks=[];signal.value=value;signal.rank=signal.calculateRank();signal.eq=eq||egal}function CombinedSignal(parents,f,eq){this.parents=parents;this.f=f;var value=this.calculate();initSignal(this,value,eq)}CombinedSignal.prototype=new Signal;CombinedSignal.prototype.calculateRank=function(){return Math.max.apply(Math,util.pluck(this.parents,"rank"))+1};CombinedSignal.prototype.calculate=function(){return this.f.apply(undefined,util.pluck(this.parents,"value"))};Signal.prototype.map=function(f,eq){var mapped=new CombinedSignal([this],f,eq);this.children.push(mapped);return mapped};Signal.prototype.onValue=function(callback){var wrapped=function(x){callback(x)};this.callbacks.push(wrapped);callback(this.value);var that=this;return function(){var index=that.callbacks.indexOf(wrapped);if(index!==-1){that.callbacks.splice(index,1)}}};function Source(initialValue,eq){initSignal(this,initialValue,eq)}function source(initialValue,eq){return new Source(initialValue,eq)}Source.prototype=new Signal;Source.prototype.calculateRank=function(){return 0};Source.prototype.set=function(transaction,value){transaction.addAction({type:"set",signal:this,value:value})};Source.prototype.modify=function(transaction,f){transaction.addAction({type:"modify",signal:this,f:f})};function combine(){var signals=Array.prototype.slice.call(arguments,0,-1);var f=arguments[arguments.length-1];var mapped=new CombinedSignal(signals,f);signals.forEach(function(parent){parent.children.push(mapped)});return mapped}module.exports={Signal:Signal,source:source,combine:combine}},{"./egal.js":1,"./util.js":6}],5:[function(_dereq_,module,exports){"use strict";var util=_dereq_("./util.js");function Transaction(){this.actions=[];this.commitScheduled=false}function transaction(){return new Transaction}Transaction.prototype.commit=function(){if(this.commitScheduled){clearTimeout(this.commitScheduled);this.commitScheduled=false}if(this.actions.length===0){return}var updates=[];this.actions.forEach(function(action){var update;var len=updates.length;for(var i=0;i<len;i++){if(action.signal===updates[i].signal){update=updates[i];break}}if(!update){update={signal:action.signal,value:action.signal.value};updates.push(update)}switch(action.type){case"set":update.value=action.value;break;case"modify":update.value=action.f(update.value);break}});var updated=[];updates.forEach(function(update){if(!update.signal.eq(update.signal.value,update.value)){update.signal.value=update.value;updated.push(update.signal)}});var signals=[];updated.forEach(function(update){update.children.forEach(function(child){if(signals.indexOf(child)===-1){signals.push(child)}})});while(signals.length!==0){var len=signals.length;var rank=Math.min.apply(Math,util.pluck(signals,"rank"));for(var i=0;i<len;i++){var signal=signals[i];if(signal.rank!==rank){continue}var value=signal.calculate();if(!signal.eq(signal.value,value)){signal.value=value;updated.push(signal);var childrenlen=signal.children.length;for(var j=0;j<childrenlen;j++){var child=signal.children[i];if(signals.indexOf(child)===-1){signals.push(child)}}}signals[i]=undefined}signals=signals.filter(util.identity)}updated.forEach(function(updatedSignal){updatedSignal.callbacks.forEach(function(callback){callback(updatedSignal.value)})});this.actions=[]};Transaction.prototype.rollback=function(){if(this.commitScheduled){clearTimeout(this.commitScheduled)}this.actions=[];this.commitScheduled=false};Transaction.prototype.deferCommit=function(){if(!this.commitScheduled){var tx=this;this.commitScheduled=setTimeout(function(){tx.commit()})}};Transaction.prototype.addAction=function(action){this.actions.push(action);this.deferCommit()};module.exports=transaction},{"./util.js":6}],6:[function(_dereq_,module,exports){"use strict";function identity(x){return x}function pluck(arr,property){var len=arr.length;var res=new Array(len);for(var i=0;i<len;i++){res[i]=arr[i][property]}return res}module.exports={identity:identity,pluck:pluck}},{}]},{},[2])(2)});
//# sourceMappingURL=dist/menrva.min.js.map